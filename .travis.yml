#######################################################
# DO NOT EDIT THIS FILE!                              #
#                                                     #
# It's auto-generated by symfony-cmf/dev-kit package. #
#######################################################

############################################################################
# This file is part of the Symfony CMF package.                            #
#                                                                          #
# (c) 2011-2017 Symfony CMF                                                #
#                                                                          #
# For the full copyright and license information, please view the LICENSE  #
# file that was distributed with this source code.                         #
############################################################################

language: php
sudo: false
cache:
    directories:
        - $HOME/.composer/cache/files
        - $HOME/symfony-bridge/.phpunit
env:
      matrix: DEPENDENCIES=4.0.*
      global:
        - PHPUNIT_FLAGS="-v"
        - SYMFONY_PHPUNIT_DIR="$HOME/symfony-bridge/.phpunit"

        - SYMFONY_DEPRECATIONS_HELPER="24"
        - SYMFONY_PHPUNIT_DIR=.phpunit SYMFONY_PHPUNIT_REMOVE="symfony/yaml"
        - KERNEL_CLASS=Symfony\Cmf\Bundle\SeoBundle\Tests\Fixtures\App\Kernel
        - SYMFONY_PHPUNIT_VERSION=5.7
        - TEST_INSTALLATION=false

matrix:
  fast_finish: true
  include:
    - php: 7.2
      env:  COMPOSER_FLAGS="--prefer-lowest" SYMFONY_DEPRECATIONS_HELPER=weak_vendors
    - php: 7.0
      env:  COMPOSER_FLAGS="--prefer-lowest" SYMFONY_DEPRECATIONS_HELPER=weak_vendors

    - php: 7.0
    - php: 7.1
    - php: 7.2
      env: COVERAGE=true PHPUNIT_FLAGS="-v --coverage-text"

    - php: 7.2
      env:  DEPENDENCIES="symfony/lts:^2"
    - php: 7.2
      env:  DEPENDENCIES="symfony/lts:^3"
    - php: 7.2
      env: STABILITY=dev
    - env: TEST_INSTALLATION=true
  allow_failures:
    - env: TEST_INSTALLATION=true
    - php: 7.2
      env: STABILITY=dev

before_install:
  - composer self-update
  - composer validate --no-check-all --ansi
  - if [[ $COVERAGE != true ]]; then phpenv config-rm xdebug.ini || true; fi
  - if ! [ -z "$STABILITY" ]; then composer config minimum-stability ${STABILITY}; fi;
  - if ! [ -v "$DEPENDENCIES" ]; then composer require --no-update ${DEPENDENCIES}; fi;
  - export BRANCH=$(if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then echo $TRAVIS_BRANCH; else echo $TRAVIS_PULL_REQUEST_BRANCH; fi)

install: travis_wait composer update --prefer-dist $COMPOSER_FLAGS
script:
  - if [ "${TEST_INSTALLATION}" == true ]; then make test_installation; else make test; fi

notifications:
  irc: "irc.freenode.org#symfony-cmf"
